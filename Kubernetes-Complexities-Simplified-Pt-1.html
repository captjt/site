<!DOCTYPE html>
<html>
<head>
    <!-- [[! Document Settings ]] -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- [[! Page Meta ]] -->
    <title>Kubernetes: Complexities Simplified Pt. 1</title>
    <meta name="description" content="Ushering In Growth - My development story begins here." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/assets/images/favicon.ico" >

    <!-- [[! Styles'n'Scripts ]] -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css"
          href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />

    <!-- [[! highlight.js ]] -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- [[! Ghost outputs important style and meta data with this tag ]] -->
        <link rel="canonical" href="/" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="/page2/" />

    <meta property="og:site_name" content="Ushering In Growth" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Ushering In Growth" />
    <meta property="og:description" content="My development story begins here." />
    <meta property="og:url" content="/" />
    <meta property="og:image" content="/assets/images/cover1.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Ushering In Growth" />
    <meta name="twitter:description" content="My development story begins here." />
    <meta name="twitter:url" content="/" />
    <meta name="twitter:image:src" content="/assets/images/cover1.jpg" />

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "Ushering In Growth",
    "url": "/",
    "image": "/assets/images/cover1.jpg",
    "description": "My development story begins here."
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="Ushering In Growth" href="/feed.xml" />


</head>
<body class="home-template nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Home</a></li>
        <li class="nav-about " role="presentation"><a href="/about">About</a></li>
        <li class="nav-technologies " role="presentation"><a href="/tag/technologies">Technlogoies</a></li>
        <!--<li class="nav-speeches " role="presentation"><a href="/tag/speeches">Speeches</a></li>
        <li class="nav-fiction " role="presentation"><a href="/tag/fiction">Fiction</a></li>-->
        <li class="nav-author " role="presentation"><a href="/author/jt">Author</a></li>
    </ul>
    <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- [[! Everything else gets inserted here ]] -->
        <!-- < default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<header class="main-header post-head " style="background-image: url(/assets/images/looking-up.jpg) ">
    <nav class="main-nav  overlay  clearfix">
        <a class="blog-logo" href="/"><img src="/assets/images/logo.png" alt="Blog Logo" /></a>
        
            <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
        
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-content tag-technologies">

        <header class="post-header">
            <h1 class="post-title">Kubernetes: Complexities Simplified Pt. 1</h1>
            <section class="post-meta">
            <!-- <a href='/'>Jordan Taylor</a> -->
            <time class="post-date" datetime="2017-03-22">22 Mar 2017</time>
                <!-- [[tags prefix=" on "]] -->
                 
                on 
                
                    
                       <a href='/tag/technologies'>Technologies</a>
                       
                
                
            </section>
        </header>

        <section class="post-content">
            
            <h2 id="why-are-microservices-hard">Why Are Microservices Hard?</h2>

<p>Conceptually when moving to microservices it will solve a lot of major problems we face with monolithic applications. The overhead that I mentioned in the later portion of <a href="http://jt.codes/Migration-to-Microservices">Introduction on Migrating to Microservices</a> can be hard to wrap our heads around. We need to establish tracing, monitoring, load balancing, service discovery, dynamic request routing, TLS, circuit breaking and more. <strong>What are these things and what do they even mean?!</strong></p>

<h3 id="complexities-say-what">Complexities… Say What??</h3>

<p>What is distributed tracing, service discovery, circuit breaking…? – The list goes on. One of these, distributed tracing, is one of the most underrated tools to help with monitoring our services. Distributed tracing is key to what is going on within a single call into our microservice architecture. We can follow the lifespan of a request, see what’s going on and where things are getting bottled up.</p>

<p><em>Distributed tracing provides a holistic view of requests transiting through multiple services, allowing for immediate identification of latency issues.</em></p>

<h3 id="one-tool-to-rule-them-all">One Tool To Rule Them All</h3>

<blockquote>
  <p>“Enter Linkerd”</p>
</blockquote>

<p><a href="https://linkerd.io/">Linkerd</a> is an open source project that is built off of Twitter’s <a href="https://twitter.github.io/finagle/">finagle</a>. It doesn’t lock developers into a single JVM, .NET, JS, etc. language. It’s core principle is catering to developers as they migrated to these complex system architectures.</p>

<p>Linkerd solves many of the fundamental problems we face with microservices. While distributed tracing is at the center of this article. I will, in the near future, go more in depth about other complexities Linkerd solves.</p>

<h3 id="hands-on">Hands On</h3>

<p>The Buoyant <a href="https://blog.buoyant.io/">blog</a> is a fantastic way to get started with Linkerd. They truly simpilfy how things are working under the covers and give real examples of how to incorporate Linkerd into your architecture.</p>

<p>Since <a href="https://k8s.io/">Kubernetes</a> is the <a href="https://www.youtube.com/watch?v=3MyYhSnHGm0">“Linux of the Cloud”</a> I am going to walkthrough a quick example of using <a href="http://zipkin.io/">Zipkin</a> and Linkerd – running on Kubernetes as a DaemonSet. Zipkin simply is a distributed tracing tool. The source code for this walkthrough is <a href="https://github.com/jtaylor32/woogidi-woogidi-woogidi">here</a>.</p>

<h3 id="kubernetes-creating-the-services-and-pods">Kubernetes: Creating the Services and Pods</h3>

<p>You can set your <code class="highlighter-rouge">namespaces</code> separately, but this is a simple tutorial on how to stand up an app insides Kubernetes and have traffic routed and traced using Linkerd + Zipkin. Note: Commands will be based on a <a href="https://github.com/kubernetes/minikube">minikube</a> cluster – can be ported to actual Kubernetes seamlessly.</p>

<h4 id="installconfigure-linkerd">Install/Configure Linkerd</h4>

<p>This command will apply a ConfigMap for Linkerd as a DaemonSet to route traffic in and out of specific ports.</p>

<p><code class="highlighter-rouge">bash
kubectl apply -f https://raw.githubusercontent.com/jtaylor32/woogidi-woogidi-woogidi/master/k8s-configs/linkerd-zipkin.yml
</code></p>

<p>Once the service is running you can open the admin dashboard. This will be where you can monitor inbound/outbound traffic; as well as configure your routing within the “dtab” and other cool features.</p>

<p><code class="highlighter-rouge">bash
minikube service l5d
</code></p>

<p><img src="./../assets/images/linkerd-dashboard.jpg" alt="linkerd-dashboard" />
<em>Linkerd Dashboard</em></p>

<p>Run the service. This should create a replication set of 3 pods named “woogidi” (reminiscing on <a href="https://en.wikipedia.org/wiki/Rocket_Power">Rocket Power</a> days). This service will be listening on <em>port 8080</em>.</p>

<p><code class="highlighter-rouge">bash
kubectl apply -f https://raw.githubusercontent.com/jtaylor32/woogidi-woogidi-woogidi/master/k8s-configs/woogidi-woogidi-woogidi.yml
</code></p>

<p>To check if the service is working correctly we can do a simple curl commands.</p>

<p>```bash
# Set the L5D_INGRESS_LB so we can http_proxy to the service 
L5D_INGRESS_LB=$(minikube service l5d –url | head -n1)</p>

<p>http_proxy=$L5D_INGRESS_LB curl -XPOST -d ‘{“gnarly”: “Otto”}’ http://woogidi/</p>

<p>{“response”:”let’s crank Otto”}
```</p>

<p>Sick. Us and Otto are going to go shred some gnar! This is all because the Linkerd service that is running is configured to route traffic to this service. It acts as a service discovery tool as well!</p>

<p>But what if something is getting bottlenecked somewhere in the request chain or is failing and we can’t detect that? Here is where we need to configure Zipkin inside our cluster.</p>

<p><code class="highlighter-rouge">bash
kubectl apply -f https://raw.githubusercontent.com/jtaylor32/woogidi-woogidi-woogidi/master/k8s-configs/zipkin.yml
</code></p>

<p>Open the Zipkin dashboard once the service starts.</p>

<p><code class="highlighter-rouge">bash
minikube service zipkin
</code></p>

<p>The dashboard allows us to do some filtering on requests that are going through the Linkerd service. We can also dive into specific requests and calls within Zipkin.</p>

<h4 id="snapshots-of-zipkin-interface">Snapshots of Zipkin Interface</h4>

<p><img src="./../assets/images/zipkin-dashboard.jpg" alt="zipkin-dashboard" />
<em>Zipkin Dashboard</em></p>

<p><img src="./../assets/images/zipkin-single-call.jpg" alt="zipkin-single-call" />
<em>Single Request</em></p>

<p><img src="./../assets/images/zipkin-details.jpg" alt="zipkin-details" />
<em>Single Trace Call</em></p>

<h3 id="whats-next">What’s Next?</h3>

<p>Now we can monitor, tracing and do some simple service discovery within Kubernetes we need to expand and have log monitoring, ingress (load balancing), and other features solved.</p>

<ul>
  <li>
    <p>Log monitoring will include – <a href="https://github.com/prometheus">Prometheus</a> + <a href="https://github.com/grafana/grafana">Grafana</a>.</p>
  </li>
  <li>
    <p>Ingress will include a way to traffic our requests to Linkerd using <a href="https://github.com/nginx/nginx">nginx</a> as our proxy.</p>
  </li>
</ul>

<blockquote>
  <p>Feel free to reach out to me and ask questions or bring up other topics you’d like me to write about!</p>
</blockquote>

<p><img src="./../assets/images/tito-later.jpg" alt="later-bro!" /></p>


        </section>

        <footer class="post-footer">

            <!-- Everything inside the #author tags pulls data from the author -->
            <!-- #author-->

            
            <figure class="author-image">
                <a class="img" href="/author/jt" style="background-image: url(/assets/images/gopher-me.png)"><span class="hidden">'s Picture</span></a>
            </figure>
            

            <section class="author">
                <h4><a href="/author/jt">Jordan Taylor</a></h4>
                
                
                    <p> Software Engineer. DC. Radford Baseball Alum.</p>
                
                <div class="author-meta">
                    <span class="author-location icon-location"> Viringia, USA</span> 
                    <span class="author-link icon-link"><a href="https://github.com/jtaylor32"> github</a></span> 
                </div>
            </section>

            <!-- /author  -->

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Kubernetes: Complexities Simplified Pt. 1&amp;url=https://github.com/jtaylor32Kubernetes-Complexities-Simplified-Pt-1"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://github.com/jtaylor32Kubernetes-Complexities-Simplified-Pt-1"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://github.com/jtaylor32Kubernetes-Complexities-Simplified-Pt-1"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>
            
            <!-- Add Disqus Comments -->
            
            
        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/future-technologies.jpg)" href="/Migration-to-Microservices">
            <section class="post">
                <h2>Introduction on Migrating to Microservices</h2>
                <p>Why Microservices? This is an obvious question raised when applications or companies move to a...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->


        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">Ushering In Growth</a> &copy; 2017</section>
          <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/biomadeira/jasper">Jasper</a></section>
        </footer>
    </div>
    <!-- [[! Ghost outputs important scripts and data with this tag ]] -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <!-- [[! The main JavaScript file for Casper ]] -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-81287416-1', 'auto');
	    ga('send', 'pageview');

     </script>   
</body>
</html>
